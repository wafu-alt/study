출처 : 엘리스 SW엔지니어 트랙
# 1. async / await 배우기

## try / catch 문법

```jsx
try {
	JSON.parse("test");
	// throw "Error!";
} catch (e){
	console.log("Error :" + e);
} finally {
	console.log("Always call");
}
```

- 예외 처리를 위한 문법
- try 블럭 내에서 에러가 발생하면 catch 블럭에서 처리할 수 있다
- throw를 통해서 일부러 에러를 발생 시킬 수 있다
```jsx
try {
  JSON.parse("test");
  throw "Error!";
} catch (e) {
  console.log("Error: " + e); //문법에러
} finally {
  console.log("Always call"); //에러 나도 동작
}

try {
  JSON.parse("test");
  console.log(a);
  let a;
  let b = 1;
  b.toUpperCase();
  throw new TypeError("type error!");
} catch (e) {
  if (e instanceof ReferenceError) {
    console.log("ReferenceError");
  } else if (e instanceof SyntaxError) {
    console.log("SyntaxError"); //문법에러
  } else if (e instanceof TypeError) {
    console.log("TypeError");
  }
  console.log("Error: " + e);
}
```
## async function

- 비동기 함수임을 선언하는 함수
- 함수를 실행하면 Promise객체를 반환함
- 명시적으로 Promise객체를 반환해도 동일함

```jsx
async function f(){
	return 1;
}
async function f(){
	return Promise.resolve(1);
}
```

- 두 함수는 똑같은 결과를 반환함
- Promise가 아닌 값을 반환하더라도 무조건 Promise로 감싸서 반환됨

```jsx
function sleep(ms) {
  const start = Date.now();
  while (Date.now() - start < ms);
}

function getData() {
  return new Promise((resolve, reject) => {
    try {
      sleep(1000);
      const userInfo = {
        user: {
          id: "elice",
          password: "1234",
        },
        createDate: "2022-04-30",
      };
      resolve(userInfo);
    } catch (err) {
      reject(err);
    }
  });
}

function parseValue(data) {
  return new Promise((resolve, reject) => {
    try {
      resolve(data.user);
    } catch (err) {
      reject(err);
    }
  });
}

function auth(user) {
  return new Promise((resolve, reject) => {
    if (user.id == "elice" && user.password == "1234") {
      resolve("ok");
    } else {
      resolve("ID 혹은 비밀번호가 틀립니다.");
    }
  });
}

function display(result) {
  return new Promise((resolve, reject) => {
    if (result == "ok") {
      console.log("로그인 성공");
    } else {
      console.log(result);
    }
    resolve();
  });
}

/* 
//바꾸기전
getData() //1. 데이터를 가공. 프로미스를 반환하고 2번 감
  .then(parseValue) //2.에서 프로미스를 반환하고 3번 감
  .then(auth) //3.에서 프로미스를 반환하고 4번 감
  .then(display) //4.에서 프로미스를 반환하고, 에러 찾고 끝
  .catch((err) => console.log(err));

*/

//async써주면 프로미스가 됨
async function run() {
  //1. 함수로 만들고 async 붙여줌
  try {
    //try로 에러 날시 catch로 연결하기 위함
    const step1 = await getData(); //2. 데이터 받아옴
    const step2 = await parseValue(step1); //3. 데이터를 가공함
    const step3 = await auth(step2); //4. 유저 검증하고 반환
    const step4 = await display(step3); //5.view해주고 반환
  } catch (err) {
    console.log(err);
  }
}
run(); //함수호출
```
